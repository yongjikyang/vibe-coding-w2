name: ğŸ·ï¸ ì´ìŠˆ ìë™ ë¼ë²¨ë§

on:
  issues:
    types: [opened, reopened, edited]

jobs:
  issue-labeler:
    runs-on: ubuntu-latest
    steps:
    - name: ğŸ” ì´ìŠˆ ë¶„ì„ ë° ë¼ë²¨ë§
      uses: actions/github-script@v6
      with:
        script: |
          const issue = context.payload.issue;
          const title = issue.title.toLowerCase();
          const body = (issue.body || '').toLowerCase();
          
          let labels = [];
          
          // íƒ€ì…ë³„ ë¼ë²¨
          if (title.includes('[bug]') || title.includes('bug') || title.includes('error') || title.includes('ë¬¸ì œ') || title.includes('ì˜¤ë¥˜')) {
            labels.push('type:bug');
          } else if (title.includes('[feature]') || title.includes('ê¸°ëŠ¥') || title.includes('ì¶”ê°€') || title.includes('feature')) {
            labels.push('type:feature');
          } else if (title.includes('[docs]') || title.includes('ë¬¸ì„œ') || title.includes('documentation')) {
            labels.push('type:docs');
          } else if (title.includes('[question]') || title.includes('ì§ˆë¬¸') || title.includes('ë¬¸ì˜')) {
            labels.push('type:question');
          } else if (title.includes('[task]') || title.includes('ì‘ì—…') || title.includes('task')) {
            labels.push('type:task');
          } else if (title.includes('[enhancement]') || title.includes('ê°œì„ ') || title.includes('enhancement')) {
            labels.push('type:enhancement');
          }
          
          // ìš°ì„ ìˆœìœ„ ë¼ë²¨
          if (title.includes('urgent') || title.includes('critical') || title.includes('ê¸´ê¸‰') || title.includes('ì¤‘ìš”')) {
            labels.push('priority:high');
          } else if (title.includes('low') || title.includes('ë‚®ìŒ') || title.includes('minor')) {
            labels.push('priority:low');
          } else {
            labels.push('priority:medium');
          }
          
          // ì˜ì—­ë³„ ë¼ë²¨
          if (title.includes('backend') || title.includes('api') || title.includes('server') || title.includes('ë°±ì—”ë“œ')) {
            labels.push('area:backend');
          }
          if (title.includes('frontend') || title.includes('ui') || title.includes('ux') || title.includes('í”„ë¡ íŠ¸')) {
            labels.push('area:frontend');
          }
          if (title.includes('docs') || title.includes('ë¬¸ì„œ') || title.includes('documentation')) {
            labels.push('area:docs');
          }
          if (title.includes('ci') || title.includes('cd') || title.includes('deploy') || title.includes('ë°°í¬')) {
            labels.push('area:ci');
          }
          
          // íŠ¹ìˆ˜ ìƒí™© ë¼ë²¨
          if (body.includes('screenshot') || body.includes('ìŠ¤í¬ë¦°ìƒ·') || body.includes('![')) {
            labels.push('has-screenshot');
          }
          if (body.includes('reproduce') || body.includes('ì¬í˜„') || body.includes('steps')) {
            labels.push('has-reproduction');
          }
          if (body.length > 1000) {
            labels.push('detailed-description');
          }
          
          // ì¤‘ë³µ ì œê±°
          labels = [...new Set(labels)];
          
          try {
            // ë¼ë²¨ ì¶”ê°€
            if (labels.length > 0) {
              await github.rest.issues.addLabels({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.issue.number,
                labels: labels
              });
              
              // ë¼ë²¨ë§ ê²°ê³¼ ëŒ“ê¸€
              const comment = `
              ## ğŸ·ï¸ ìë™ ë¼ë²¨ë§ ì™„ë£Œ
              
              ë‹¤ìŒ ë¼ë²¨ë“¤ì´ ìë™ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤:
              ${labels.map(label => `\`${label}\``).join(', ')}
              
              ë¼ë²¨ì´ ì˜ëª» ì„¤ì •ëœ ê²½ìš° ìˆ˜ë™ìœ¼ë¡œ ìˆ˜ì •í•´ ì£¼ì„¸ìš”! ğŸ™
              `;
              
              await github.rest.issues.createComment({
                issue_number: context.issue.number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                body: comment
              });
            }
          } catch (error) {
            console.log('ë¼ë²¨ë§ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error.message);
          } 